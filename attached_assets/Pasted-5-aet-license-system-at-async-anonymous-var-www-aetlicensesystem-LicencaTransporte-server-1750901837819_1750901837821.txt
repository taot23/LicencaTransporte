5|aet-license-system  |     at async <anonymous> (/var/www/aetlicensesystem/LicencaTransporte/server/routes.ts:3632:7) {
5|aet-license-system  |   length: 330,
5|aet-license-system  |   severity: 'ERROR',
5|aet-license-system  |   code: '23503',
5|aet-license-system  |   detail: 'Key (id)=(4) is still referenced from table "status_histories".',
5|aet-license-system  |   hint: undefined,
5|aet-license-system  |   position: undefined,
5|aet-license-system  |   internalPosition: undefined,
5|aet-license-system  |   internalQuery: undefined,
5|aet-license-system  |   where: undefined,
5|aet-license-system  |   schema: 'public',
5|aet-license-system  |   table: 'status_histories',
5|aet-license-system  |   column: undefined,
5|aet-license-system  |   dataType: undefined,
5|aet-license-system  |   constraint: 'status_histories_user_id_users_id_fk',
5|aet-license-system  |   file: 'ri_triggers.c',
5|aet-license-system  |   line: '2478',
5|aet-license-system  |   routine: 'ri_ReportViolation'
5|aet-license-system  | }
5|aet-license-system  | 1:36:45 AM [express] DELETE /api/admin/users/4 500 in 13ms :: {"message":"Erro ao excluir usuário"}
5|aet-license-system  | [AUTH DEBUG] Deserializing user ID: 1
5|aet-license-system  | [AUTH DEBUG] User deserialized: admin@sistema.com (role: admin)
5|aet-license-system  | Transaction failed: error: update or delete on table "users" violates foreign key constraint "status_histories_user_id_users_id_fk" on table "status_histories"
5|aet-license-system  |     at /var/www/aetlicensesystem/LicencaTransporte/node_modules/pg/lib/client.js:545:17
5|aet-license-system  |     at process.processTicksAndRejections (node:internal/process/task_queues:95:5)
5|aet-license-system  |     at async <anonymous> (/var/www/aetlicensesystem/LicencaTransporte/node_modules/src/node-postgres/session.ts:104:19)
5|aet-license-system  |     at async <anonymous> (/var/www/aetlicensesystem/LicencaTransporte/server/transactional-storage.ts:101:22)
5|aet-license-system  |     at async withTransaction (/var/www/aetlicensesystem/LicencaTransporte/server/db.ts:78:20)
5|aet-license-system  |     at async TransactionalStorage.deleteUser (/var/www/aetlicensesystem/LicencaTransporte/server/transactional-storage.ts:93:5)
5|aet-license-system  |     at async <anonymous> (/var/www/aetlicensesystem/LicencaTransporte/server/routes.ts:3632:7) {
5|aet-license-system  |   length: 330,
5|aet-license-system  |   severity: 'ERROR',
5|aet-license-system  |   code: '23503',
5|aet-license-system  |   detail: 'Key (id)=(4) is still referenced from table "status_histories".',
5|aet-license-system  |   hint: undefined,
5|aet-license-system  |   position: undefined,
5|aet-license-system  |   internalPosition: undefined,
5|aet-license-system  |   internalQuery: undefined,
5|aet-license-system  |   where: undefined,
5|aet-license-system  |   schema: 'public',
5|aet-license-system  |   table: 'status_histories',
5|aet-license-system  |   column: undefined,
5|aet-license-system  |   dataType: undefined,
5|aet-license-system  |   constraint: 'status_histories_user_id_users_id_fk',
5|aet-license-system  |   file: 'ri_triggers.c',
5|aet-license-system  |   line: '2478',
5|aet-license-system  |   routine: 'ri_ReportViolation'
5|aet-license-system  | }
5|aet-license-system  | Erro ao excluir usuário: error: update or delete on table "users" violates foreign key constraint "status_histories_user_id_users_id_fk" on table "status_histories"
5|aet-license-system  |     at /var/www/aetlicensesystem/LicencaTransporte/node_modules/pg/lib/client.js:545:17
5|aet-license-system  |     at process.processTicksAndRejections (node:internal/process/task_queues:95:5)
5|aet-license-system  |     at async <anonymous> (/var/www/aetlicensesystem/LicencaTransporte/node_modules/src/node-postgres/session.ts:104:19)
5|aet-license-system  |     at async <anonymous> (/var/www/aetlicensesystem/LicencaTransporte/server/transactional-storage.ts:101:22)
5|aet-license-system  |     at async withTransaction (/var/www/aetlicensesystem/LicencaTransporte/server/db.ts:78:20)
5|aet-license-system  |     at async TransactionalStorage.deleteUser (/var/www/aetlicensesystem/LicencaTransporte/server/transactional-storage.ts:93:5)
5|aet-license-system  |     at async <anonymous> (/var/www/aetlicensesystem/LicencaTransporte/server/routes.ts:3632:7) {
5|aet-license-system  |   length: 330,
5|aet-license-system  |   severity: 'ERROR',
5|aet-license-system  |   code: '23503',
5|aet-license-system  |   detail: 'Key (id)=(4) is still referenced from table "status_histories".',
5|aet-license-system  |   hint: undefined,
5|aet-license-system  |   position: undefined,
5|aet-license-system  |   internalPosition: undefined,
5|aet-license-system  |   internalQuery: undefined,
5|aet-license-system  |   where: undefined,
5|aet-license-system  |   schema: 'public',
5|aet-license-system  |   table: 'status_histories',
5|aet-license-system  |   column: undefined,
5|aet-license-system  |   dataType: undefined,
5|aet-license-system  |   constraint: 'status_histories_user_id_users_id_fk',
5|aet-license-system  |   file: 'ri_triggers.c',
5|aet-license-system  |   line: '2478',
5|aet-license-system  |   routine: 'ri_ReportViolation'
5|aet-license-system  | }
5|aet-license-system  | 1:36:46 AM [express] DELETE /api/admin/users/4 500 in 11ms :: {"message":"Erro ao excluir usuário"}